---
layout: post
title: Git+GPG
tag: 
---

<blockquote><p>GNU Privacy Guard（GnuPG或GPG）是一种加密软件，它是PGP加密软件的满足GPL的替代物。GnuPG依照由IETF订定的OpenPGP技术标准设计[2]。GnuPG用于加密、数字签名及产生非对称匙对的软件。 –<a href="https://zh.m.wikipedia.org/wiki/GnuPG" target="_blank" rel="noopener">Wikipedia</a><br><a id="more"></a></p></blockquote><p>因此我们可以用GPG密钥来签名我们的Git文件，并添加到Github以校验文件的完整性。</p><h1 id="以下内容翻译自Github的官方手册"><a href="#以下内容翻译自Github的官方手册" class="headerlink" title="以下内容翻译自Github的官方手册"></a>以下内容翻译自Github的官方手册</h1><p>首先，我们需要安装GnuPG<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">apt install gunpg -y</span><br></pre></td></tr></table></figure></p><p>运行<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gpg --gen-key</span><br></pre></td></tr></table></figure></p><p>生成我们的密钥<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line">(GnuPG) 1.4.22; Copyright (C) 2015 Free Software Foundation, Inc.</span><br><span class="line">This is free software: you are free to change and redistribute it.</span><br><span class="line">There is NO WARRANTY, to the extent permitted by law.</span><br><span class="line"><span class="meta">#</span><span class="bash">此为版权内容</span></span><br><span class="line"></span><br><span class="line">Please select what kind of key you want:</span><br><span class="line">   (1) RSA and RSA (default)</span><br><span class="line">   (2) DSA and Elgamal</span><br><span class="line">   (3) DSA (sign only)</span><br><span class="line">   (4) RSA (sign only)</span><br><span class="line"><span class="meta">#</span><span class="bash">选择密钥类型推荐使用DSA and Elgamal</span></span><br><span class="line">Your selection?2</span><br><span class="line"><span class="meta">#</span><span class="bash">密钥位数，性能低选2048，反之3072</span></span><br><span class="line">A keys may be between 1024 and 3072 bits long.</span><br><span class="line">What keysize do you want? (2048)3072</span><br><span class="line"><span class="meta">#</span><span class="bash">密钥有效期，自己保存选0即可</span></span><br><span class="line">Please specify how long the key should be valid.</span><br><span class="line">         0 = key does not expire</span><br><span class="line">      &lt;n&gt;  = key expires in n days</span><br><span class="line">      &lt;n&gt;w = key expires in n weeks</span><br><span class="line">      &lt;n&gt;m = key expires in n months</span><br><span class="line">      &lt;n&gt;y = key expires in n years</span><br><span class="line">Key is valid for? (0)0</span><br><span class="line">Key does not expire at all</span><br><span class="line"><span class="meta">#</span><span class="bash">是对的吗？(y)</span></span><br><span class="line">Is this correct? (y/N)y</span><br><span class="line">You need a user ID to identify your key; the software constructs the user ID</span><br><span class="line">from the Real Name, Comment and Email Address in this form:</span><br><span class="line">    "Heinrich Heine (Der Dichter) &lt;heinrichh@duesseldorf.de&gt;"</span><br><span class="line"><span class="meta">#</span><span class="bash">键入用户名,至少五位</span></span><br><span class="line">Real name:**</span><br><span class="line"><span class="meta">#</span><span class="bash">电邮</span></span><br><span class="line">E-mail address:</span><br><span class="line"><span class="meta">#</span><span class="bash">描述</span></span><br><span class="line">Comment:**</span><br><span class="line">You selected this USER-ID:</span><br><span class="line">    "* (*) &lt;*@*&gt;"</span><br><span class="line"><span class="meta">#</span><span class="bash">确定</span></span><br><span class="line">Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit?O</span><br><span class="line">You need a Passphrase to protect your secret key.</span><br><span class="line"><span class="meta">#</span><span class="bash">密码，不可见</span></span><br><span class="line">Enter passphrase:</span><br><span class="line"><span class="meta">#</span><span class="bash">接着开始生成，尽可能多做些琐碎事</span></span><br></pre></td></tr></table></figure></p><p>然后，我们获取Key<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> gpg --list-secret-keys --keyid-format LONG /Users/hubot/.gnupg/secring.gpg ------------------------------------ sec 4096R/%%3AA5C34371567BD2%% 2016-03-10 [expires: 2017-03-10] uid Hubot</span></span><br><span class="line">ssb   4096R/42B317FD4BA89E7A 2016-03-10</span><br><span class="line"><span class="meta">#</span><span class="bash">这是一个示例，输出结果可能不同</span></span><br><span class="line"><span class="meta">$</span><span class="bash"> gpg --armor --<span class="built_in">export</span> 3AA5C34371567BD2 <span class="comment">#上句命令中的%%___%%部分</span></span></span><br><span class="line"><span class="meta">#</span><span class="bash">复制输出结果</span></span><br></pre></td></tr></table></figure></p><p>添加公钥至Github<br><a href="https://github.com/settings/keys" target="_blank" rel="noopener">点我</a></p><p>告诉git你的密钥信息<br><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global user.signingkey 3AA5C34371567BD2 #上句命令中的%%___%%部分</span><br><span class="line">echo 'export GPG_TTY=$(tty)' &gt;&gt; ~/.bashrc</span><br></pre></td></tr></table></figure></p><p>配置仓库总是使用gnupg签名<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git config commit.gpgsign true</span><br></pre></td></tr></table></figure> ,全局仓库都使用<code>git config --global commit.gpgsign true</code></p>
